\section{Mappe Ricorsive}%
\label{sub:Mappe Ricorsive}
Ricordiamo che una mappa ricorsiva è definita da:
\[
    \vect{x}_{n+1} = G(\vect{x}_n) \qquad \vect{x}_n \in \mathbb{R}^n; \qquad G:\mathbb{R}^n\to \mathbb{R}^n
.\] 
\begin{enumerate}
    \item La mappa è invertibile se $\exists \ G^{-1}$.
    \item La mappa è $C^r$ se esistono e sono continue le derivate\sidenote{\scriptsize Intese come parziali in più dimensioni} di $G$ fino all'ordine $r$.
\end{enumerate}
Se valgono la $1)$ e la $2)$ allora si ha un \textbf{Diffeomorfismo} $C^r$.
\subsection{Orbita per mappa ricorsiva invertibile}%
\label{sub:Orbita per mappa ricorsiva invertibile}
Se la mappa è invertibile allora preso un punto $\vect{x}_0$ è possibile muoversi verso destra (con $G$) o verso sinistra con $G^{-1}$.
\[
    \ldots, \ G^{-1}(\vect{x}_0), \ G^{-1}(\vect{x}_0), \ \vect{x}_0, \ G(\vect{x}_0), \ G^2(\vect{x}_0), \ \ldots
.\] 
\begin{exmp}[Mappa lineare]
    \[
        x_{n+1} = a x_n \qquad a \in \mathbb{R} - \left\{0\right\}
    .\] 
    Questa mappa è invertibile: basta spostare il parametro $a$ a sinistra per ricavare la preimmagine.
\end{exmp}
\noindent
Le mappe più studiate sono quelle non invertibili, questo perché al variare dei loro parametri si possono generare dei comportamenti particolari (caos).\\
Ci sono casi in cui anche le mappe all'apparenza invertibili possono generare situazioni complicate, ad esempio quelle che presentano un modulo come vedremo negli esempi di questa sezione.
\subsection{Orbita per mappa ricorsiva non invertibile}%
\label{sub:Orbita per mappa ricorsiva non invertibile}
Preso un punto $\vect{x}_0$ per una mappa non invertibile è possibile spostarsi soltanto verso destra tramite la $G$.
\[
    \vect{x}_0, \ G(\vect{x}_0), \ G^2(\vect{x}_0), \ \ldots
.\] 
\begin{exmp}[Mappa logistica]
    \[
        x_{n+1} = 3.5 x_n \left(1- x_n\right) \qquad x_n \in \left[0,1\right]
    .\] 
    Questa mappa non è invertibile: la preimmagine non è univoca (un'equazione del secondo grado ha due soluzioni).
\end{exmp}
\noindent
\begin{exmp}[Mappa di Bernoulli]
    \[
	x_{n+1}=2x_n \quad \text{mod}(1)
    .\] 
    Questa mappa è parente della shift-map poiché, scegliendo di rappresentare $x$ in base due, la mappa agisce allo stesso modo sui coefficienti della espansione (di base due) di come agiva con i simboli la shift map.
    \marginpar{
        \captionsetup{type=figure}
            \incfig{4_1}
        \caption{\scriptsize Mappa di Bernoulli, si vede come la linea rossa non rappresenti una funzione iniettiva: non può essere invertibile.}
        \label{fig:4_1}
    }\\
    L'operazione di modulo $1$ invece si occupa di traslare in $[0,1]$ il punto $x_{n+1}$ ogni volta che esce dall'intervallo a causa all'applicazione della mappa. \\
    L'operazione di traslazione avviene tramite un intero $n$ tale che:
    \[
	n = \text{min}(k \in \mathbb{Z}): \ 0 \le x+n \le 1
    .\] 
    Pur essendo lineare (all'apparenza) questa mappa può esibire un comportamento complesso. La presenza del modulo infatti fa si che la mappa non sia invertibile, come si può vedere in figura \ref{fig:4_1}.
\end{exmp}
\noindent
    \begin{exmp}[Circle Rotation Map]
	Prendiamo una classe di mappe generale del seguente tipo:
        \[
	    x_{n+1} = G(x_n) \qquad x_n \in S_1
        .\] 
	$S_1$ rappresenta il cerchio di raggio unitario, quindi i punti della mappa appartengono tutti al cerchio e sono rappresentati da una variabile: l'angolo di rotazione $x\cdot 2\pi$ (con $x \in \left[0,1\right]$).
	\marginpar{
	    \captionsetup{type=figure}
	        \incfig{4_2}
	    \caption{\scriptsize Rappresentazione della Circle Rotation Map.}
	    \label{fig:4_2}
	}\\
	La Circle Rotation Map è un caso particolare di queste mappe, ovvero:
	\[
	    x_{n+1}=x_n+\alpha  \quad \text{mod}(1); \qquad \alpha\in [0,1[
	.\] 
	La caratteristica principale di questa mappa è che può essere:
	\begin{itemize}
	    \item \textbf{$k$-periodica} se $\alpha$ razionale: le orbite degli $x_n$ si richiudono.
	    \item \textbf{Quasi periodica} se $\alpha$ irrazionale: i punti della mappa si distribuiscono uniformemente sul cerchio unitario (questo è il caso mostrato in figura \ref{fig:4_2}).
	\end{itemize}
	La mappa è sempre invertibile. 
\end{exmp}
\noindent
\begin{exmp}[Mappa di Arnold]
        \[
	    x_{n+1} = x_n + \omega  - \frac{k}{2\pi}\sin (2\pi x_n) \qquad \text{mod}(1) 
        .\] 
	$k, \omega$ sono costanti e $k>0$, la mappa non è lineare a causa della presenza del $\sin$.\\
	Il parametro $\omega$ può essere interpretato come il rapporto tra due frequenze: una intrinseca del sistema ed una forzante esterna.
	\[
	    \omega  \sim \frac{\omega_{\text{int}}}{\omega_{\text{ext}}}; \qquad \omega \in \left[0,1\right]
	.\]
	La mappa mostra le seguenti peculiarità:
	\begin{itemize}
	    \item $0\le k\le 1$: la mappa di comporta come la Circle Map, presenta orbite periodiche o quasi periodiche a seconda della razionalità di $\omega$. 
	    \item $k>1$: la mappa può esibire comportamenti caotici.
	\end{itemize}
	Nel caso di $k=1$ la mappa inizia a riscontrare alcune "anomalie", è il valore per il quale iniziano a rompersi le "lingue di Arnold".
\end{exmp}
\noindent
\begin{ex}[Sulla mappa di Arnold]
       Dimostrare che la mappa di Arnold è invertibile se $0\le k\le 1$.\\
       \textbf{Soluzione}:
       \marginpar{
           \captionsetup{type=figure}
           \includegraphics[width=\marginparwidth]{figures/4_3_py.png}
	   \caption{\scriptsize Mappa di Arnold al variare di $k$ con $\omega  = 0.4$ fissato.}
           \label{fig:4_3_py-png}
       }
       Come possiamo vedere in figura \ref{fig:4_3_py-png} la mappa non presenta criticità (è invertibile) se non nell'intorno di $x_n=0$ oppure $x_n=1$. \\
       Prendiamo ad esempio la mappa con $k=0.1$ e valutiamo\sidenote{\scriptsize Questa corrisponde (circa) alla circle rotation map} il punto $x_n=0$: la linea rossa, che rappresenta la mappa, a destra di questo punto vale $\omega+\epsilon$, a sinistra di questo punto vale $\omega-\epsilon$. La pendenza della curva in questo punto è quindi positiva.\\
       La presenza della perturbazione oscillante fa si che i due "rami" della mappa si avvicinino l'un l'altro, di conseguenza se la perturbazione è abbastanza forte è possibile che in un punto tra $0$ e $1$ il ramo in alto e quello in basso abbiano la stessa $x_{n+1}$: si perde l'iniettività e quindi l'invertibilità.\\
       Nel grafico la perdita di iniettività si ha quando la mappa oltrepassa la linea tratteggiata (che rappresenta la separatrice tra i rami).\\
       Per capire quando questo succede possiamo studiare la pendenza della mappa nei pressi di $x_n = 0$ (considerandola di fatto come una funzione continua).
       \[
	   x_{n+1} = x_n + \omega + k x_n = (1-k) x_n + \omega
       .\] 
       Se in un intorno (destro) di questo punto la pendenza della curva è negativa allora significa che la mappa è scesa sotto $\omega$ e quindi ha perso l'iniettività: deve essere $k\le 1$ per avere pendenza positiva.
\end{ex}
\noindent
\section{Spazio delle fasi esteso (SD a tempi continui)}%
\label{sub:Spazio delle fasi esteso (SD a tempi continui)}
Si prende un sistema dinamico a tempi continui autonomo e lo si perturba con una componente dipendente dal tempo (un fattore esterno). Il sistema in questo modo diventa non autonomo, l'equazione generale che regola questo tipo di sistema è:
\[
    \frac{\text{d} \vect{x}}{\text{d} t} = F(\vect{x},t) \qquad \vect{x}\in \mathbb{R}^n; \ F: \mathbb{R}^n \times \mathbb{R}\to \mathbb{R}^n
.\] 
Possiamo ricondurre questo sistema ad un sistema autonomo tramite una trasformazione nella variabile temporale:
\[
    t = m(s) = s \implies  \frac{\text{d} }{\text{d} t} = \frac{\text{d} s}{\text{d} t} \frac{\text{d} }{\text{d} s} 
.\] 
Inserendo nella equazione del moto:
\[
    \frac{\text{d} \vect{x}}{\text{d} t} = \frac{\text{d} s}{\text{d} t} \frac{\text{d} \vect{x}}{\text{d} s} = F(\vect{x}, t)
.\] 
Possiamo definire il differenziale di $t$  rispetto a $s$: $dt /ds = 1$.
\[
    \begin{cases}
	\frac{\text{d} \vect{x} (s)}{\text{d} s} = F(\vect{x}, t)\\
	\frac{\text{d} t}{\text{d} s} = 1
    \end{cases}
\] 
\begin{defn}[Spazio delle fasi esteso]
    Si definisce spazio delle fasi esteso la quantità:
    \[
	\vect{y} =(\vect{x}, t) \in \mathbb{R}^n \times \mathbb{R}
    .\] 
\end{defn}
\noindent
In questo modo, definendo anche il funzionale esteso:
\[
    H = (F(\vect{x}, t), 1)
.\] 
Si possono generalizzare le equazioni del moto come:
\[
    \frac{\text{d} \vect{y}}{\text{d} s} = H(\vect{y})
.\] 
Per quanto il problema sia formalmente risolto si deve tenere in considerazione che il nuovo spazio delle fasi potrebbe non essere più un compatto.\\
Questa mancanza potrebbe diventare un problema nei nostri scopi in quanto siamo spesso interessati alla soluzione asintotica del sistema (che potrebbe smettere di esistere).\\
In ogni caso aggiungiamo che, se la forzante è periodica, il sistema può essere sempre gestito con questo metodo.
\begin{exmp}[Forzante oscillante]
    \[
	\frac{\text{d} ^2x}{\text{d} t^2} = -x + A\sin (\omega t)
    .\] 
    Come sempre si riporta l'equazione ad una di primo ordine:
    \[
        \begin{cases}
            \frac{\text{d} x}{\text{d} t} = y \\
	    \frac{\text{d} y}{\text{d} t} = -x + A \sin (\omega t)
        \end{cases}
    \] 
    Adesso si introduce la variabile $\theta (t)=\omega t$. Il nuovo sistema, con questa variabile, è descritto nello spazio delle fasi generalizzato e le equazioni sono le seguenti:
    \[
        \begin{cases}
            \frac{\text{d} x}{\text{d} t} = y\\
	    \frac{\text{d} x}{\text{d} t} = -x + A\sin\theta\\
	    \frac{\text{d} \theta}{\text{d} t} =\omega
        \end{cases}
    \] 
    Si noti che la variabile $\theta$ non è limitata, quindi lo spazio delle fasi non è più un compatto.
\end{exmp}
\noindent
\subsection{Flusso di fase}%
\label{sub:Flusso di fase}
Dato un sistema dinamico a tempo continuo in $\mathbb{R}^2$:
\[
    \frac{\text{d} \vect{x}}{\text{d} t} = A\vect{x}
.\] 
\[
    \vect{x} = \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}  \qquad A = \begin{pmatrix} - \Gamma  & 0 \\ 0 & \Gamma \end{pmatrix}; \ \Gamma  \in \mathbb{R}
.\] 
Studiamone l'evoluzione risolvendo il problema alle condizioni iniziali:
\[
    \begin{cases}
        \frac{\text{d} x_1}{\text{d} t} = -\Gamma  x_1\\
	\frac{\text{d} x_2}{\text{d} t} = \Gamma x_2\\
	\vect{x} (0)=\vect{x}_0
    \end{cases}
\] 
La soluzione può essere espressa tramite il seguente vettore:
\[
    \vect{x} (t)= 
    \begin{pmatrix}  
	x_{10}e^{-\Gamma t}\\
	x_{20}e^{\Gamma t}
    \end{pmatrix} 
.\] 
Oppure possiamo scriverla in termini di matrice:
\[
    \vect{x} (t)=
    \begin{pmatrix} 
    e^{-\Gamma t} & 0 \\
    0 & e^{\Gamma t}
    \end{pmatrix} 
    \begin{pmatrix} 
	x_{10}\\
	x_{20}
    \end{pmatrix} 
    \equiv \varphi_t (\vect{x}_0)
.\] 
\begin{defn}[Flusso di fase]
    L'operatore $\varphi_t$ definito come
    \[
        \varphi_t: \mathbb{R}^2 \to \mathbb{R}^2; \quad 
	\varphi_t = 
	\begin{pmatrix} 
	    e^{-\Gamma t} & 0 \\
	    0 & e^{\Gamma t} 
        \end{pmatrix} 
    .\] 
    Si dice flusso di fase del sistema.
\end{defn}
\noindent
\paragraph{Proprietà del flusso di fase}%
\label{par:Proprietà del flusso di fase}
\begin{enumerate}
    \item $\varphi_t(\vect{x}_0)$ è una soluzione dell'IVP.
    \item $\varphi_0(\vect{x}_0) = \vect{x}_0$ 
    \item $\varphi_{t+s}(\vect{x}_0)=\varphi_t(\varphi_s(\vect{x}_0))$ 
\end{enumerate}
\begin{ex}[Sul flusso di fase]
    Verificare la validità delle 3 proprietà per:
    \[
        \varphi_t = 
	\begin{pmatrix} 
	    e^{-\Gamma t} & 0 \\
	    0 & e^{\Gamma t} 
        \end{pmatrix} 
    .\] 
\end{ex}
\noindent
Notiamo che se $\varphi_t$  è invertibile allora il suo inverso è $\varphi_{-t}$.  
\begin{exmp}[Flusso unodimensionale]
    \[
        \begin{cases}
            \frac{\text{d} x}{\text{d} t} = x^2-1\\
	    x(0) = x_0
        \end{cases}
    .\] 
    Prima di ricavare il flusso di fase determiniamo la soluzione:
    \[
        \frac{dx}{x^2-1} = dt \implies  dx \left[\frac{1}{x-1}-\frac{1}{x+1}\right] = dt
    .\] 
    Integrando a destra e sinistra:
    \[
	\log (\frac{\left|x-1\right|}{\left|x+1\right|}) = 2t + c
    .\] 
    Per ricavare $x(t)$  è necessario uno studio di funzione all'interno del logaritmo per capire quando è necessaria una inversione di segno nel suo argomento.\\
    Per $\left|x\right| > 1$  l'argomento è positivo, possiamo procedere in tal caso a risolvere con l'elevamento a potenza:
    \[
        \frac{x-1}{x+1}=e^{2t}B
    .\] 
    La costante $B$  si determina imponendo la condizione iniziale $x(0)=x_0$:
    \[
        B=\frac{x_0-1}{x_0+1}
    .\] 
    In conclusione la soluzione è:
    \[
	x(t) = \frac{(x_0+1)+e^{2t}(x_0-1)}{(x_0+1) -e^{2t}(x_0-1)} = \varphi_t(x_0)
    .\] 
    In questo caso abbiamo un flusso che non è rappresentato da una matrice ma da un funzionale. Possiamo dimostrare che è un flusso: le prime due richieste sono ovvie. La terza invece è lasciata per esercizio, si tratta di fare tanti conti.
\end{exmp}
\noindent
